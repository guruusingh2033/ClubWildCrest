@model WildCrest.Models.WildCrestModels.Profile
@{ 
    bool renew =DateTime.ParseExact(Model.MembershipExpiryDate, "MM/dd/yyyy",null) > DateTime.Today ? true : false;
}
<style>
    td {
            padding: 5px;
            }
#ui-datepicker-div {
            z-index: 9999!important;
        }
    .memberhistory {
        height: 480px;
        overflow-x: hidden;
        overflow-y: scroll;
    }
    .renewpopup {
        height: 370px;
        overflow-x: hidden;
        overflow-y: scroll;
    }
    .historyBtn {
        margin-left: auto;
        background: #ffffff;
        color: #009efb;
    }
    .historyBtn:hover {
        margin-left: auto;
        background: #ffffff;
        color: #009efb;
    }
    #MemberHistory .modal-dialog {
        max-width: 810px;
    }
</style>
<body class="fix-header card-no-border">

    <div id="main-wrapper">

        <div class="row">
            <div class="col-md-12 info_common">
                <div class="card">
                    <div class="card-block">
                        <a href="/Member/Index" style="margin-bottom: 20px;" class="btn btn-primary">Go Back</a>
                        <h4 class="card-title">Member Info</h4>

                        <div class="form p-t-20">
                            @if (Model.ID != 0)
                            {
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">First Name</label>
                                        <input type="text" id="firstName" readonly value="@Model.F_Name" class="form-control">
                                    </div>
                                </div>

                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Last Name</label>
                                        <input type="text" id="lastName" readonly value="@Model.L_Name" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Father Name</label>
                                        <input type="text" id="fatherName" readonly value="@Model.FatherName" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Reference By</label>
                                        <input type="text" id="reference" readonly value="@Model.Reference_Of_Walk_In" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label>Add on Member Name</label>
                                        <input type="text" readonly id="addonMember" class="form-control" value="@Model.Addon_Member" />
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label>Relationship</label>
                                        <input type="text" readonly id="relation" class="form-control" value="@Model.Relationship" />
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">MemberID</label>
                                        <input type="text" id="customMemID" readonly value="@Model.CustomMemberID" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">DOB :</label>
                                        <input type="text" id="DOB" readonly value="@Model.DOB" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Aadhar_No. :</label>
                                        <input type="text" id="AadharNo" readonly value="@Model.AadharNo" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">PAN_Card :</label>
                                        <input type="text" id="PAN_Card" readonly value="@Model.PAN_Card" class="form-control">
                                    </div>
                                </div>

                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Email :</label>
                                        <input type="text" id="Email" readonly value="@Model.Email" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Email Notifications:</label>
                                        <input type="text" id="EmailNotification" readonly value="@(Model.EmailNotifications == true ? "Yes" : "No")" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Phone :</label>
                                        <input type="text" id="Phone" readonly value="@Model.PhoneNo" class="form-control">
                                    </div>
                                </div>

                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Address :</label>
                                        <input type="text" id="Address" readonly value="@Model.Address" class="form-control">
                                    </div>
                                </div>

                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">City :</label>
                                        <input type="text" id="City" readonly value="@Model.City" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">State :</label>
                                        <input type="text" id="State" readonly value="@Model.State" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Current Membership :</label>
                                        <input type="text" id="CurrentMembership" readonly value="@ViewBag.CurrentMembership" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Membership Joining Date :</label>
                                        <input type="text" id="joiningDate" readonly value="@Model.MembershipJoiningDate" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Membership Expiry Date :</label>
                                        <input type="text" id="expiryDate" readonly value="@Model.MembershipExpiryDate" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Amount Paid:</label>
                                        <input type="text" id="amt" readonly class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Payment Mode :</label>
                                        <input type="text" id="paymentMode" readonly class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Check No. :</label>
                                        <input type="text" id="checkNo" readonly class="form-control" />
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Bank Name :</label>
                                        <input type="text" id="bankName" readonly class="form-control" />
                                    </div>
                                </div>

                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label>Plan Amount</label>
                                        <input type="text" readonly class="form-control" id="pAmt" value="0" />
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 form-profile-in">
                                    <div class="form-group">
                                        <label>GST (18%)</label>
                                        <input type="text" readonly class="form-control" id="Pgst" value="0" />
                                    </div>
                                </div>
                                <div class="col-md-12 col-sm-12 form-profile-in">
                                    <div class="form-group">
                                        <label>Additional Notes</label>
                                        <textarea id="notes" readonly rows="3" class="form-control">@Model.Additional_Notes</textarea>
                                    </div>
                                </div>
                                <div class="col-md-12 col-sm-12 form-profile-in">
                                    @if (Request.Cookies["UserType"].Value == "1")
                                    {
                                        <button type="button" disabled="@renew" class="btn btn-primary btn-margin" data-toggle="modal" data-target="#Renewal_Member">Renewal Membership</button>
                                    }
                                    @if (Request.Cookies["PageSetting"] != null)
                                    {
                                        if (Request.Cookies["PageSetting"]["MemberPermission"] != "View")
                                        {
                                            @Html.ActionLink("Edit", "MemberDetailsByID", "Member", new { id = Model.ID }, new { @class = "btn btn-primary btn-margin" })
                                        }
                                    }
                                    else
                                    {
                                        @Html.ActionLink("Edit", "MemberDetailsByID", "Member", new { id = Model.ID }, new { @class = "btn btn-primary btn-margin" })
                                    }
                                    <input type="button" value="Print" onclick="PrintMemBill();" class="btn btn-primary" />
                                </div>
                            }
                            else
                            {
                                <label>No Record Found.</label>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @if (ViewBag.UserStays != null)
    {
        <div class="row">
            <div class="col-md-12 info_common member_stay_details">
                <div class="card">
                    <div class="card-block">
                        <h4 class="card-title d-flex align-items-center">Member Stays Details  <button onclick="GetMemberHistory('@Model.ID')" class="btn btn-primary historyBtn">History</button></h4>

                        <div class="form p-t-20">
                            @if (ViewBag.UserStays.Count != 0)
                            {
                                <div class="col-md-4 col-sm-12 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Total Stays this Year :</label>
                                        <input type="text" id="TotalStays" readonly value="@ViewBag.TotalStays" class="form-control">
                                    </div>
                                </div>

                                <div class="col-md-4 col-sm-12 form-profile-in">
                                    <div class="form-group">
                                        <label class="control-label">Complementary Stays Taken :</label>
                                        <input type="text" id="Complementary" readonly value="@ViewBag.Complementary" class="form-control">
                                    </div>
                                </div>

                                @*<div class="col-md-4 col-sm-12 form-profile-in">
                                        <div class="form-group">
                                            <label class="control-label">Total Night Stays :</label>
                                            <input type="text" id="DOB" readonly value="@ViewBag.NightStays" class="form-control">
                                        </div>
                                    </div>*@

                                <div class="table-responsive m-t-40">
                                    <table id="memberList" class="display nowrap table table-hover table-striped table-bordered" cellspacing="0" width="100%">
                                        <thead>
                                            <tr>
                                                <th>Check-in</th>
                                                <th>Check-out</th>
                                                <th>No. of Members</th>
                                                <th>Room(s)</th>
                                                <th>Complementary Stays Taken</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var a in ViewBag.UserStays)
                                            {
                                                <tr>
                                                    <td>@a.Check_In</td>
                                                    <td>@a.Check_Out</td>
                                                    <td>
                                                        @a.NoOfPerson
                                                    @* @if (a.NoOfMembers != 0)
                                                        {@a.NoOfMembers}
                                                        else
                                                        {
                                                            <center>  <label>1</label></center>
                                                        }*@
                                                </td>
                                                <td>@a.RoomNo</td>
                                                <td>@a.ComplementaryStays</td>
                                            </tr>
                                        }
                                        </tbody>
                                    </table>

                                </div>
                            }
                            else
                            {
                                <label style="font-size: 20px;">------</label>
                            }

                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
    @if (ViewBag.MembersPhoto != null || ViewBag.MembersDOcs != null)
    {
        if (ViewBag.MembersPhoto.Count != 0 || ViewBag.MembersDOcs.Count != 0)
        {
            <div class="row">
                <div class="col-md-12 info_common member_stay_details">
                    <div class="card">
                        <div class="card-block">
                            <h4 class="card-title">Member's Photo or Docs</h4>
                            <div class="form p-t-20 membersImgDocs">
                                @if (ViewBag.MembersPhoto.Count != 0)
                                {
                                    <label><b>Member's Photo :</b></label>
                                    <div class="row">
                                        @foreach (var img in ViewBag.MembersPhoto)
                                        {
                                            <div class="col-md-3 col-sm-6">
                                                <a href="@img.MemberImagePath" target="_blank">
                                                    <img src="@img.MemberImagePath" class="img-responsive" />
                                                </a>
                                            </div>
                                        }
                                    </div>
                                }

                                @if (ViewBag.MembersDOcs.Count != 0)
                                {
                                    <label><b>Member's Docs :</b></label>
                                    <div class="row">
                                        @foreach (var img in ViewBag.MembersDOcs)
                                        {
                                            <div class="col-md-3 col-sm-6">
                                                <a href="@img.MemberDocsPath" target="_blank">
                                                    <img src="@img.MemberDocsPath" class="img-responsive" />
                                                </a>
                                            </div>
                                        }
                                    </div>
                                }

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    <div id="MemberHistory" class="modal fade" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header" style="background:#0698ef;">
                    <h5 class="modal-title" style="color:white;">Membership History</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" >
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                
                <div class="modal-body  memberhistory">

                    


                </div>



            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <div id="Renewal_Member" class="modal fade" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header" style="background:#0698ef;">
                    <h4 class="modal-title" style="color:white;">Renewal Membership</h4>
                </div>
                <div class="modal-body renewpopup">
                    <i>
                        <div id="error" style="color: red; font-size: 13px; font-weight: 400;"></div>
                    </i>
                    @*<div class="form-group">
                        <label>New MemberID (Required)</label>
                        <div class="input-group">
                            <div class="input-group-addon"><i class="ti-user" aria-hidden="true" style="font-size: initial"></i></div>
                            <input type="text" class="form-control" id="CustomMember_ID" placeholder="@Model.CustomMemberID" />
                        </div>
                    </div>*@
                    <div class="form-group">
                        <label style="font-size: large;">Membership Plan :</label>
                        <div class="input-group">
                            <div class="input-group-addon"><i class="ti-email" style="font-size: initial"></i></div>
                            <select id="MembershipPlan" class="form-control" onchange="ChangePlan()">

                                @foreach (var s in ViewBag.MembershipPlans)
                                {
                                    <option value="@s.ID">@s.PlanName</option>
                                }
                            </select>
                        </div>
                    </div>
                    <i>
                        <label style="color: green; font-size: 13px; font-weight: 400;">Plan Amount:<span id="planAmount"></span></label>

                    </i>
                    <div class="form-group">
                        <label>New MembershipJoiningDate(Required)</label>
                        <div class="input-group">
                            <div class="input-group-addon"><i class="fa fa-calendar" aria-hidden="true" style="font-size: initial"></i></div>
                            <input type="text" readonly class="form-control clsDatePicker" id="MembershipJoining_Date" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6">
                            <label>Amount Paid <span class="complusoryFields">*</span></label>
                            <input type="text" class="form-control floatNo requiredFields" id="amountrenew" />
                        </div>
                        <div class="col-md-6 col-sm-6" id="mode_pay">
                            <label>Mode of Payment :</label>
                            <select onchange="paymentMode();" class="form-control" id="paymentModeRenew">
                                <option value="Cash">Cash</option>
                                <option value="Cheque">Cheque</option>
                                <option value="Card">Card</option>
                            </select>
                        </div>
                        <div id="cheque" style="display: none;" class="col-md-6 col-sm-6">
                            <label>Cheque No. <span class="complusoryFields">*</span></label>
                            <input type="text" class="form-control requiredFields" id="chequeNorenew" />
                        </div>
                        <div id="cheque1" style="display: none;" class="col-md-6 col-sm-6">
                            <label>Bank Name <span class="complusoryFields">*</span></label>
                            <input type="text" class="form-control requiredFields" id="bankNamerenew" />
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6" style="margin: 10px 0;">
                            <label>Plan Amount</label>
                            <input type="text" readonly class="form-control" id="pamtreNew" value="0" />
                        </div>
                        <div class="col-md-6 col-sm-6" style="margin: 10px 0;">
                            <label style="color: black; font-weight: 500;">GST (18%)</label>
                            <input type="text" readonly class="form-control" id="Pgstrenew" value="0" />
                        </div>
                    </div>



                </div>


                <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="close_create_order_Modal();">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="Renewal();">Update</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
</body>
<script>
    function ChangePlan() {
        
        @foreach (var s in ViewBag.MembershipPlans)
        {
            <text>
        if (@s.ID == $("#MembershipPlan").val())
        {
            $("#planAmount").html('@s.PlanAmount');
            
        }
        </text>
        }
            
        };
    $("#amountrenew").on("keypress keyup blur", function (event) {
        $(this).val($(this).val().replace(/[^0-9\.]/g, ''));
        if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
            event.preventDefault();
        }
    });
    $("#amountrenew").focusout(function () {
        
        var amt = $("#amountrenew").val().trim();
        var planAmt = 0;
        var gst = 0;
        if (parseFloat(amt) > 0) {                          // Tax 18%
            planAmt = ((parseFloat(amt) * 100) / 118).toFixed(2);
            gst = (parseFloat(planAmt) * (18 / 100)).toFixed(2);

            $("#pamtreNew").val(planAmt);
            $("#Pgstrenew").val(gst);
        }
        else {
            $("#pamtreNew").val('0');
            $("#Pgstrenew").val('0');
        }
    });
    function paymentMode() {
      
        var mode = $("#paymentModeRenew").val();
        if (mode == "Cheque") {
            $("#cheque").css("display", "block");
            $("#cheque1").css("display", "block");
            $("#chequeNorenew").val('');
            $("#bankNamerenew").val('');
        }
        //else if (mode == "Card")
        //{
        //    $("#cheque").css("display", "none");
        //    $("#card").css("display", "block");
        //}
        else {
            $("#cheque").css("display", "none");
            $("#cheque1").css("display", "none");
            $("#chequeNorenew").val('');
            $("#bankNamerenew").val('');
        }
    }
    function close_create_order_Modal() {
        //$("#CustomMember_ID").val('');
        $("#MembershipPlan").val(@Model.MembershipPlanIDForUser);
        $('#error').html('');
        $("#amountrenew").val('');
        $("#chequeNorenew").val('');
        $("#bankNamerenew").val('');
        $("#pamtreNew").val('');
        $("#Pgstrenew").val('');
        $("#Renewal_Member").modal('hide');
    }
    function Renewal() {
        //if ($("#CustomMember_ID").val() == "") {
        //    $("#error").html('');
        //    $("#error").html("enter new memberid");
        //    return false;
        //}
            if ($("#amountrenew").val().trim()=="") {
                $(".preloader").css("display", "none");
                $("#error").html('');
                $("#error").html("Amount paid is required.");
                return false;
            }

            var mode = $("#paymentModeRenew").val();
            var chequeNo = $("#chequeNorenew").val().trim();
            var bankName = $("#bankNamerenew").val().trim();
            if (mode == "Cheque" && (chequeNo == "" || bankName == "")) {
                $(".preloader").css("display", "none");
                $("#error").html('');
                $("#error").html("Cheque no. & Bank Name are compulsory.");
                return false;
            }
            
           
                $.ajax({
                    type: "post",
                    contentType: "application/json; charset=utf-8",
                    url: "/Member/RenewalMemberDetailsByID",
                    //data: JSON.stringify({ prf }),
                    data:JSON.stringify({
                        UserID: @Model.ID,
                        MembershipJoiningDate: $("#MembershipJoining_Date").val(),
                        MembershipPlanID: $("#MembershipPlan").val(),
                        Amount_Paid: $("#amountrenew").val(),
                        Cheque_No: chequeNo,
                        Mode_Of_Payment: mode,
                        BankName: bankName
                    }),
                    dataType: "json",
          
                    success: function (response) {
                        if (response!="") {
                            newWin = window.open("");
                            //==================================================================================

                            var amt = $("#amountrenew").val();
                            var planAmt = 0;
                            var gst = 0;
                            if (parseFloat(amt) > 0) {                          // Tax 18%
                                planAmt = ((parseFloat(amt) * 100) / 118).toFixed(2);
                                gst = (parseFloat(planAmt) * (18 / 100)).toFixed(2);
                            }

                            var tbl = '';
                            tbl += "<center><p style='padding:0px;margin:0px;font-size:12px;'>Club Wild Crest";
                            tbl += "<br>A Venture of Virk Gold Farms Pvt. Ltd.</p></center><hr>";

                            tbl += '<table id="memberData" style="width:100%;margin:0 auto; ">' +
                                '<tbody  style="text-align: left;" >' +
                                '<tr style="font-size: 9px;">' +
                                '<td style="padding: 5px 0;">Customer Name : ' + '@Model.F_Name' + " " + '@Model.L_Name' + '</td>' +
                                '<td style="padding: 5px 0;">Phone No. : ' +'@Model.PhoneNo' + '</td>' +

                                '</tr>' +
                                '<tr style="font-size: 9px;">' +
                                '<td style="padding: 5px 0;">Membership Plan : ' + $("#MembershipPlan  option:selected").text() + '</td>' +
                                '<td style="padding: 5px 0;">Joining Date : ' + $('#MembershipJoining_Date').val() + '</td>' +

                                '</tr>' +
                                '<tr style="font-size: 9px;">' +
                                '<td style="padding: 5px 0;">Expiry Date : ' + response.ExpiryDate + '</td>' +
                                '<td style="padding: 5px 0;">Plan Amount : ₹ ' + planAmt + '</td>' +

                                '</tr>' +
                                '<tr style="font-size: 9px;">' +
                                '<td style="padding: 5px 0;">GST(18%) : ₹ ' + gst + '</td>' +
                                '<td style="padding: 5px 0;">Payment Mode : ' + $("#paymentModeRenew").val() + '</td>' +

                                '</tr>' +
                                '<tr style="font-size: 9px;">' +
                                '<td style="padding: 5px 0;">Amount Paid : ₹ ' + $("#amountrenew").val() + '</td>' +
                                '<td style="padding: 5px 0;"></td>' +
                                '</tr>' +
                                '</tbody></table>';

                            var htmlToPrint = '' +
                                '<style type="text/css">' +
                                'body{font-family: arial;}' +
                                '@@media print{@@page{size: 72mm auto;margin:5px;}}' +
                                '</style>';
                            htmlToPrint += tbl;
                            newWin.document.open();
                            newWin.document.write(htmlToPrint);
                            newWin.print();
                            newWin.close();






                            bootbox.confirm("Member Updated Successfully.", function (result) {
                                close_create_order_Modal();
                                window.location.reload();
                            });
                        }else{
                            bootbox.confirm("Member Updated UnSuccessfull.", function (result) {
                                close_create_order_Modal();
                                window.location.reload();
                            });
                        }
                    }
    
                });
        
       
            
       
    }
    function GetMemberHistory(ID) {
        $.ajax({
            type: "GET",
            contentType: "application/json; charset=utf-8",
            url: "/Member/GetMembershipHistoryByUserID/?userId="+ID,
             dataType: "HTML",

            success: function (response) {
                $(".memberhistory").html();
                $(".memberhistory").html(response);
                $("#MemberHistory").modal("show");
            }
        })
    };

    $(document).ready(function () {
        var date = new Date();
        $('#MembershipJoining_Date').datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'mm/dd/yy',
            minDate: date
        });
       
        $("#MembershipJoining_Date").datepicker("setDate", new Date());
        $("#MembershipPlan").val(@Model.MembershipPlanIDForUser);
        ChangePlan();
        //-------------
        var jsonString = '@Model.billingDetailsInJson';
        if (jsonString != "") {
            var data = jsonString.replace(/&quot;/g, "\"");
            data = $.parseJSON(data);
            $("#amt").val(data.Amount_Paid);
            $("#paymentMode").val(data.Mode_Of_Payment);
            $("#checkNo").val(data.Cheque_No);
            $("#bankName").val(data.BankName);
            var amt = $("#amt").val();
            var planAmt = 0;
            var gst = 0;
            if (parseFloat(amt) > 0) {                          // Tax 18%
                planAmt = ((parseFloat(amt) * 100) / 118).toFixed(2);
                gst = (parseFloat(planAmt) * (18 / 100)).toFixed(2);
                $("#pAmt").val(planAmt);
                $("#Pgst").val(gst);
            }


            if (data.Mode_Of_Payment != "Cheque") {
                $("#checkNo").closest(".form-profile-in").css("display", "none");
                $("#bankName").closest(".form-profile-in").css("display", "none");
            }
            else {
                $("#checkNo").closest(".form-profile-in").css("display", "block");
                $("#bankName").closest(".form-profile-in").css("display", "block");
            }
        }
    });

    function PrintMemBill() {
        $(".preloader").css("display", "block");
        newWin = window.open("");
        var amt = $("#amt").val();
        var planAmt = 0;
        var gst = 0;
        var scgst = 0;
        if (parseFloat(amt) > 0) {                          // Tax 18%
            planAmt = ((parseFloat(amt) * 100) / 118).toFixed(2);
            gst = (parseFloat(planAmt) * (18 / 100)).toFixed(2);
            scgst = (parseFloat(gst) / 2).toFixed(2);
        }
         
        var tbl = '';
        tbl += "<center><p style='padding:0px;margin:0px;font-size:12px;'>Invoice<br>Club Wild Crest";
        tbl += "<br>A Venture of Virk Gold Farms Pvt. Ltd.</p></center><hr>";


        tbl += '<table id="bookingData" style="width:100%;margin:0 auto; ">' +
            '<tbody  style="text-align: left;" >' +
            '<tr style="font-size: 12px;font-weight:400; text-align: left;">' +
            '<td style="padding: 5px 0;">Customer Name : ' + '@Model.F_Name' + " " + '@Model.L_Name' + '</td>' +
            '<td style="padding: 5px 0;">Bill No. : ' + '@Model.MembersBillingID' + '</td>' +
            '<td style="padding: 5px 0;">Phone No. :  ' + '@Model.PhoneNo' + '</td>' +
            '</tr>' +
            '<tr style="font-size: 12px;font-weight:400; text-align: left;">' +
            '<td style="padding: 5px 0;">Membership Plan : ' + '@ViewBag.CurrentMembership' + '</td>' +
            '<td style="padding: 5px 0;">GSTIN : 09AAECV4514H1ZA</td>' +
            '<td style="padding: 5px 0;">CIN : U70102UP2013PTC056045</td>' +
            '</tr>' +
            '<tr style="font-size: 12px;font-weight:400; text-align: left;">' +
                '<td style="padding: 5px 0;">GST(18%) : ₹ ' + gst + '</td>' +
                '<td style="padding: 5px 0;">Payment Mode : ' + $("#paymentMode").val() + '</td>' +
                '<td style="padding: 5px 0;">Amount Paid : ₹ ' + $("#amt").val() + '</td>' +
            '</tr>' +
            '</tbody></table><br>';
        tbl += '<table id="tabel-heading" style="width:100%;margin:0 auto;">' +
            '<thead  style="text-align: left;" >' +
            '<tr style="font-size: 12px;font-weight:400; text-align: left;">' +
            '<th style="padding: 5px 5px;">Customer Name </th>' +
            '<th style="padding: 5px 5px;">Membership</th>' +
            '<th style="padding: 5px 5px;">Membership Amount</th>' +
            '<th style="padding: 5px 5px;">Membership Joining Date</th>' +
            '<th style="padding: 5px 5px;text-align: right;">Total</th>' +
            '</tr>' +
            '</thead>' +
            '<tbody>';

        tbl += '<tr style="font-size: 12px;text-align: left;">' +
            '<td class="border-bottom" style="padding: 8px 5px;">' + '@Model.F_Name' + " " + '@Model.L_Name' + '</td>' +

            '<td class="border-bottom" style="padding: 8px 5px;"><label>' + $("#MembershipPlan option:selected").text() + '</label></td>' +
            '<td class="border-bottom" style="padding: 8px 5px;"><label>' + planAmt + '</label></td>' +
            '<td class="border-bottom" style="padding: 8px 5px;"><label>' + '@Model.MembershipJoiningDate' + '</label></td>' +
            '<td class="border-bottom" style="padding: 8px 5px;text-align: right;"><label>₹ ' + planAmt + '</label></td>' +

            '</tr>';

        tbl += '<tr style="font-size: 12px;" class="border-top">' +

            '<td colspan="3" class="border-left"></td>' +
            '<th class="border-bottom" style="text-align: right;padding: 10px 11px 0px 11px;">Total : </th>' +
            '<td class="border-bottom" style="text-align: right;padding: 10px 2px 2px 2px;">₹ ' + planAmt + '</td>' +
            '</tr>' +


            '<tr style="font-size: 12px;">' +
            '<td colspan="3" class="border-left"></td>' +
            '<td class="border-bottom" style="text-align: right;padding: 0px 11px; ">SGST (9%) : </td>' +
            '<td class="border-bottom" style="text-align: right;padding: 2px;">₹ ' + scgst + '</td>' +
            '</tr>' +
            '<tr style="font-size: 12px;">' +
            '<td colspan="3" class="border-left"></td>' +
            '<td class="border-bottom" style="text-align: right;padding: 0px 11px; ">CGST (9%) : </td>' +
            '<td class="border-bottom" style="text-align: right;padding: 2px;">₹ ' + scgst + '</td>' +
            '</tr>' +

            '<tr style="font-size: 12px;">' +
            '<td colspan="3" class="border-left"></td>' +
            '<th class="border-bottom" style="text-align: right;padding: 0px 11px;">Net Amount(including GST) : </th>' +
            '<td class="border-bottom" style="text-align: right;padding: 2px;">₹ ' + $("#amt").val() + '</td>' +
            '</tr>';
        tbl += '<tr style=""> <td style="border:0;" colspan="3"><div style="margin-top:50px"><b>Amount (in words):</b>' + convertNumberToWords($("#amt").val()) + ' Only.</div> </td> </tr>'

        tbl += '<tr><td style="border:0;" colspan="3"></td><td style="border:0;" ><div style="margin-top:50px">For club wild crest </div></td></tr> <tr> <td colspan="3" style="border:0"></td> <td style="border:0; margin-top:0" > <div style="margin-top:40px">Incharge/Auth. Signature </div></td></tr>'


       

        var htmlToPrint = '' +
            '<style type="text/css">' +
            'body{font-family: arial;}' +
            'table#tabel-heading,#tabel-heading th,#tabel-heading td{' +
            'border-collapse:collapse;}' +

            '#tabel-heading th {' +
            'border:1px solid black;' +
            '}' +
            '#tabel-heading td {' +
            'border-right:1px solid black;' +
            'border-left:1px solid black;}' +

            '#tabel-heading .border-bottom {' +
            'border-bottom:1px solid black;}' +
            '#tabel-heading .border-top {' +
            'border-top:1px solid black;}' +
            '#tabel-heading .border-left {' +
            'border-left:none;}' +
            '</style>';
        htmlToPrint += tbl;
        newWin.document.open();
        newWin.document.write(htmlToPrint);
        newWin.print();
        newWin.close();
        $(".preloader").css("display", "none");
    }
    function convertNumberToWords(amount) {
        var words = new Array();
        words[0] = '';
        words[1] = 'One';
        words[2] = 'Two';
        words[3] = 'Three';
        words[4] = 'Four';
        words[5] = 'Five';
        words[6] = 'Six';
        words[7] = 'Seven';
        words[8] = 'Eight';
        words[9] = 'Nine';
        words[10] = 'Ten';
        words[11] = 'Eleven';
        words[12] = 'Twelve';
        words[13] = 'Thirteen';
        words[14] = 'Fourteen';
        words[15] = 'Fifteen';
        words[16] = 'Sixteen';
        words[17] = 'Seventeen';
        words[18] = 'Eighteen';
        words[19] = 'Nineteen';
        words[20] = 'Twenty';
        words[30] = 'Thirty';
        words[40] = 'Forty';
        words[50] = 'Fifty';
        words[60] = 'Sixty';
        words[70] = 'Seventy';
        words[80] = 'Eighty';
        words[90] = 'Ninety';
        amount = amount.toString();
        var atemp = amount.split(".");
        var number = atemp[0].split(",").join("");
        var n_length = number.length;
        var words_string = "";
        if (n_length <= 9) {
            var n_array = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
            var received_n_array = new Array();
            for (var i = 0; i < n_length; i++) {
                received_n_array[i] = number.substr(i, 1);
            }
            for (var i = 9 - n_length, j = 0; i < 9; i++ , j++) {
                n_array[i] = received_n_array[j];
            }
            for (var i = 0, j = 1; i < 9; i++ , j++) {
                if (i == 0 || i == 2 || i == 4 || i == 7) {
                    if (n_array[i] == 1) {
                        n_array[j] = 10 + parseInt(n_array[j]);
                        n_array[i] = 0;
                    }
                }
            }
            value = "";
            for (var i = 0; i < 9; i++) {
                if (i == 0 || i == 2 || i == 4 || i == 7) {
                    value = n_array[i] * 10;
                } else {
                    value = n_array[i];
                }
                if (value != 0) {
                    words_string += words[value] + " ";
                }
                if ((i == 1 && value != 0) || (i == 0 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Crores ";
                }
                if ((i == 3 && value != 0) || (i == 2 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Lakhs ";
                }
                if ((i == 5 && value != 0) || (i == 4 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Thousand ";
                }
                if (i == 6 && value != 0 && (n_array[i + 1] != 0 && n_array[i + 2] != 0)) {
                    words_string += "Hundred and ";
                } else if (i == 6 && value != 0) {
                    words_string += "Hundred ";
                }
            }
            words_string = words_string.split("  ").join(" ");
        }
        return words_string;
    }
</script>
